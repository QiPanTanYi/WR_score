{const e="**VMInitInjection**";if(1!==window[e]){const t=this,{window:n}=t,o="Violentmonkey",a="auto",r="content",i="expose",s="forceContent",c="ids",l=-1,d=2,u="injectInto",p="more",f="page",w="runAt",m="scripts",h="response",b="sessionId",g=e=>"function"==typeof e,y=e=>null!=e&&"object"==typeof e,v="prototype",R="__CBID",_="fileName",k=e=>"string"==typeof e,C=(e,t,n)=>{try{e&&Y(e,t)&&(n=e[t])}catch(e){}return n},L=(e,t,n,o=!0,a)=>ue(e,t,{__proto__:null,[a||"value"]:n,[!a&&"writable"]:o,configurable:o,enumerable:o}),x=e=>de(z(),e),M=(e,t,n)=>(fe(e)&&(e=x(e)),t&&P(Z,n,n=>{Y(t,n)&&(e[n]=t[n])}),e),$=(e,t,n,o)=>{var a;const r=e[t]||(e[t]=z());return null!=(a=r[n])?a:r[n]=null!=o?o:z()},T=async e=>e,E=(e="VM")=>e+me(),S=(e,...t)=>{let n=`[${o}]`;t[0]&&P(Z,t[0],e=>{n+=`[${e}]`}),t[0]=n,j(ve[e],ve,t)},D=(e,t)=>L(e,e.length,t),{apply:j}=Reflect,P=j.call.bind(j.call),{Blob:U,CustomEvent:I,Error:O,MouseEvent:F,Object:N,Promise:V,Response:B,Uint8Array:A,atob:H,addEventListener:q,cloneInto:G,chrome:W,dispatchEvent:J,removeEventListener:X}=t,z=N.create.bind(N,null),K=O,Q=B[v],Y=j.call.bind({}.hasOwnProperty),{forEach:Z,includes:ee}=[],{then:te}=V[v],{indexOf:ne,slice:oe}="",ae=j.call.bind("".charCodeAt),{append:re,appendChild:ie,attachShadow:se,remove:ce,setAttribute:le}=Element[v],{assign:de,defineProperty:ue,getOwnPropertyDescriptor:pe,getPrototypeOf:fe,keys:we}=N,{random:me}=Math,{toStringTag:he}=Symbol,{stopImmediatePropagation:be}=Event[v],ge=pe(I[v],"detail").get,ye=pe(F[v],"relatedTarget").get,ve=x(console),Re=W.runtime.getURL(""),_e=(e,t)=>{for(let n=e;y(n)&&(n=fe(n));)if(n===t)return!0},ke=(e=>t=>_e(t,e))(V[v]),{document:Ce}=t,{getElementsByTagName:Le}=Ce;let xe=!W.app;(()=>{"use strict";var x;let{browser:N}=t;if(xe||null!=(x=N)&&x.runtime);else{const{Proxy:e}=t,{bind:n}=e,a="message",r="stack",i=e=>"addListener"===e||"removeListener"===e||"hasListener"===e||"hasListeners"===e,s=(e,t,o,a)=>{const r=o[t];if(void 0===r)return;let s;return s=g(a)?a(o,r):g(r)?0===a||i(t)||!Y(o,t)?P(n,r,o):l(o,r):y(r)&&0!==a?c(r,a):r,e[t]=s,s},c=(t,n)=>new e({__proto__:null},{__proto__:null,get:(e,o)=>{var a;return null!=(a=e[o])?a:s(e,o,t,null==n?void 0:n[o])}}),l=(e,t,n)=>(...i)=>{let s,c;const l=new V((e,t)=>{s=e,c=t}),d=new K(`callstack before invoking ${t.name||"chrome API"}:`);D(i,e=>{const t=W.runtime.lastError,o=t||(n?n(s,e):s(e));o&&(t||(d[r]=`${o[1]}\n${d[r]}`),d[a]=t?o[a]:`${o[0]}`,d.isRuntime=!!t,c(d))});try{j(t,e,i)}catch(e){if("Extension context invalidated."!==e[a])throw e;ve.error(`Please reload the tab to restore ${o} API for userscripts.`)}return l},d=(e,t)=>[e,t&&(t[a]?[t[a],t[r]]:[t,(new K)[r]])],u=async(e,t)=>{try{t(d(await e))}catch(e){t(d(0,e))}},p=(e,t,n,o)=>{try{const a=e(t,n);if(a&&ke(a))return u(a,o),!0;void 0!==a&&o(d(a))}catch(e){o(d(0,e))}},f=(e,t)=>(t?t[1]:"null response")||e(t[0]),w=(e,t)=>l(e,t,f);N=t.browser=c(W,{extension:0,i18n:0,runtime:{connect:0,getManifest:0,getURL:0,onMessage:{addListener:(e,t)=>o=>P(t,e,P(n,p,null,o))},sendMessage:w},tabs:!1})}const ue=N,me="metaStr",he=t.browser;function Me(e){for(const t in e)if(Y(e,t))return!1;return!0}he.windows;const $e=/(Receiving end does not exist)|The message port closed before|$/;function Te(e,t,n){return Ee({cmd:e,data:t},n)}function Ee(e,{retry:t}={}){return t?Se(e):he.runtime.sendMessage(e)}async function Se(e,t=1e4){for(let n=performance.now();performance.now()-n<t;){try{const t=await Ee(e);if(void 0!==t)return t}catch(e){if(!$e.exec(e)[1])throw e}await he.storage.local.get(o)}throw new O(o+" cannot connect to the background page.")}const De=(e,t)=>{const o=G?G(t,Ce):t,a=new I(e,{__proto__:null,detail:o});P(J,n,a)},je=(e,t,o)=>{let a;P(q,n,e,e=>{if(P(be,e),a)a.node=P(ye,e),o.onHandle(a),a=null;else{const t=P(ge,e),r=G?G(t,n):t;a=r.node&&r,a||o.onHandle(r)}},!0),o.post=(e,a,r,i)=>{const s=o[c]?i:r,l=s&&new F(t,{__proto__:null,relatedTarget:s});De(t,{cmd:e,data:a,node:!!l}),l&&P(J,n,l)}},Pe=pe(MessageEvent[v],"data").get,{port1:Ue,port2:Ie}=new MessageChannel,Oe=Ue.postMessage.bind(Ue),Fe=z();let Ne=0;function Ve(){return new V(e=>{Fe[Ne+=1]=e,Oe(Ne)})}Ie.onmessage=e=>{const t=P(Pe,e),n=Fe[t];delete Fe[t],Ne===t&&(Ne-=1),n()};const Be=(e,t)=>C(P(Le,Ce,e),t||0),{TextDecoder:Ae}=t,{createElementNS:He}=Ce,qe=Ae[v].decode,Ge=RegExp[v].test,We=(e,t,n)=>new V(o=>{if(Be(e))o(t(n));else{const a=new MutationObserver(()=>{Be(e)&&(a.disconnect(),o(t(n)))});a.observe(Ce,{childList:!0,subtree:!0})}}),Je=(e,t)=>{const n=P(He,Ce,"http://www.w3.org/1999/xhtml",e);return t&&k(t)?P(re,n,t):t&&P(Z,we(t),e=>{"textContent"===e?P(re,n,t[e]):P(le,n,e,t[e])}),n},Xe=(e,t)=>{let n;const o=P(ne,e,","),a=o<0?"":P(oe,e,0,o),r=o<0?e:P(oe,e,o+1);if(!1===t)return`data:${a};base64,${r}`;if(n=H(r),P(Ge,/[\x80-\xFF]/,n)){const e=n.length,o=new A(e);for(let t=0;t<e;t+=1)o[t]=ae(n,t);n=t?o:P(qe,new Ae,o)}return t?new U([n],{type:a}):n},ze=z(),Ke=z(),Qe=[],Ye=(e,t,n)=>{n||tt[u]?de(e,t):Qe.push(()=>de(e,t))},Ze=Ye.bind({},ze),et=Ye.bind({},Ke),tt={__proto__:null,[c]:z(),cache:z(),pathMaps:z(),async onHandle({cmd:e,data:t,node:n},o){const a=ze[e];let r,i=t&&C(t,R);i&&(t=t.data);try{r=!0===a?Te(e,t):P(a,n,t,o||f),ke(r)&&(r=await r)}catch(e){i="Error",r=e}i&&tt.post("Callback",{id:i,data:r},o)}},nt=tt;let ot,at,rt,it;he.runtime.onMessage.addListener(async({cmd:e,data:t},n)=>{try{const o=Ke[e];o&&await o(t,n)}catch(e){ve.error(e)}}),xe&&q("copy",ot=e=>rt&&at(e),!0),Qe.push(({clipFF:e})=>{if(e){const{execCommand:e}=Ce,{setData:t}=DataTransfer[v],{get:n}=pe(ClipboardEvent[v],"clipboardData"),{preventDefault:o,stopPropagation:a}=Event[v];at=e=>{P(a,e),P(be,e),P(o,e),P(t,P(n,e),rt.type||"text/plain",rt.data)},it=t=>{rt=t,P(e,Ce,"copy"),rt=null}}Ze({SetClipboard:it||!0})});const st=z(),ct=["script","style","link","meta"],{toLowerCase:lt}="";let dt,ut;async function pt(e){if(ut){if(e){if(dt)return;dt=Ve,await dt,dt=null}Te("SetPopup",M({menus:st},nt,[c,u]))}}et({PopupShown(e){ut=e,pt()}},!0),Ze({AddElement({tag:e,attrs:t,cbId:n},o){let a,r;try{const n=this||P(ee,ct,P(lt,`${e}`))&&Be("head")||Be("body")||Be("*");a=Je(e,t),P(ie,n,a)}catch(e){r=[`${e}`,e.stack]}nt.post("Callback",{id:n,data:r},o,a)},GetResource({id:e,isBlob:t,key:n,raw:o}){var a;return o||(o=nt.cache[(null==(a=nt.pathMaps[e])?void 0:a[n])||n]),!o||Xe(o,t)},RegisterMenu({id:e,cap:t}){n===top&&($(st,e,t,1),pt(!0))},UnregisterMenu({id:e,cap:t}){var o;n===top&&(null==(o=st[e])||delete o[t],pt(!0))}});const ft=pe(PageTransitionEvent[v],"persisted").get,wt=[];let mt;function ht(e,t){D(wt,e),nt[c][e]=t||f,mt||(mt=bt(2))}async function bt(e){for(;--e>=0;)await Ve();Te("SetBadge",wt),pt(!0),mt=!1}Qe.push(()=>{Ze({Run:ht}),q("pageshow",e=>e.isTrusted&&P(ft,e)&&bt())});const gt=nt[c];let yt,vt,Rt,_t,kt,Ct,Lt,xt=n[e];function Mt({[b]:e}){kt=!1;const o=e+"VW",a=o+"*",r=E(),i=E(),s=E(),c=E();return xe?P(q,n,o,e=>{P(be,e),Ct?(P(J,Ct,new I(a,{__proto__:null,detail:Ut(P(ge,e),Ct)})),Ct=null):Ct=P(ye,e)},!0):L(t,o,Ut,!1),l(opener)||l(n!==top&&parent)?d():Et({code:`parent["${r}"] = [this, 0]`},()=>{xe&&!It(n.wrappedJSObject[r])||d()}),kt;function l(e){let t;if(e&&pe(e.location,"href").get)if(xe){const i=e=>{t=P(ge,e)};P(q,n,a,i,!0),P(J,e,new F(o,{relatedTarget:n})),P(J,e,new I(o,{detail:r})),P(X,n,a,i,!0)}else t=e[o],t=t&&t(r,n);return t}function d(){P(q,n,i,u,{capture:!0,once:!0}),Et({code:`(${xt}(${xe},'${i}','${r}'))()\n//# sourceURL=${Re}sandbox/injected-web.js`}),P(X,n,i,u,!0)}function u(e){kt=!0,P(be,e),je(s,c,nt),De(`${i}*`,[c,s])}}async function $t(e,t){var n,o;const{errors:a,info:i,[p]:c}=e;a&&ve.warn(a),xe&&(xe=parseFloat(i.ua.browserVersion)),vt=z(),vt[f]=i,vt[r]=i,de(nt.cache,e.cache),t||e[s]?kt=!1:e[f]&&null==kt&&Mt(e);const l=e[m].filter(e=>Tt(e)===r).map(e=>[e.id,e.key.data]),d=(c||l.length)&&Te("InjectionFeedback",{[s]:!kt,[r]:l,[p]:c,url:xe&&location.href}),u=pe(Document[v],"readyState").get,w=Rt;if(w&&jt(),yt=z(),await We("*",St,"start"),(null!=(n=_t)&&n.body||null!=(o=Rt)&&o.body)&&await We("body",St,"body"),c&&(e=await d)){de(nt.cache,e.cache),"loading"===P(u,Ce)&&(await new V(e=>{q("DOMContentLoaded",e,{once:!0})}),await 0);for(let t=0,n=e[m];t<n.length;t++)Tt(n[t]);Rt&&!w&&jt(),await St("end"),await St("idle")}vt=Rt=_t=xt=null}function Tt(e){let t=e[u];if(t=t===a&&!kt||t===r?r:kt&&f,t){const n=t===r?Rt||(Rt=z()):_t||(_t=z()),{gmi:o,[me]:a,pathMap:i,[w]:s}=e,c=n[s]||(n[s]=[]);D(c,e),L(o,"scriptMetaStr",a[0]||P(oe,e.code[a[1]],a[2],a[3])),delete e[me],i&&(nt.pathMaps[e.id]=i)}else gt[e.id]=l;return t}function Et(e,t){const{code:o}=e,a=y(o),r=Je("script",!a&&o),i=xe&&!t&&(t=>{const{stack:n}=t.error;n&&!`${n}`.includes(Re)||(S("error",[e.displayName],t.error),t.preventDefault())}),s=Je("div"),c=Lt||(se?P(se,s,{mode:"closed"}):s);let l,d;a&&j(re,r,o),t?(l=Je("iframe",{src:"javascript:void 0",sandbox:"allow-same-origin allow-scripts",style:"display:none!important"}),xe||P(ie,c,l)):P(ie,c,r),i&&P(q,n,"error",i),Lt||P(ie,Be("*")||Ce,s),i&&P(X,n,"error",i),t&&(Lt=c,xe&&P(ie,c,l),(d=l.contentDocument)&&(P(ie,P(Le,d,"*")[0],r),t()),P(ce,l),Lt=null),P(ce,r),P(ce,s)}function St(e){let t;for(let n=1;n>=0;n--){const o=n?f:r,a=n?_t:Rt,i=null==a?void 0:a[e];if(i){nt.post("ScriptData",{items:i,info:vt[o]},o),vt[o]=!1;for(let e=0;e<i.length;e++){const{id:t}=i[e];yt[t]=1}n?xe||(t=Dt(e)):P(te,Ve(),()=>Pt(i))}}return t}async function Dt(e){const t=_t[e];for(let n=0;n<t.length;n++){const o=t[n];o.code&&("idle"===e&&await Ve(),"end"===e&&await 0,Pt([o]),o.meta.unwrap||nt.post("Plant",o.key),Et(o),o.code="",o.meta.unwrap&&ht(o.id))}}function jt(){const e=xt(xe)(nt.onHandle),t=nt.post;nt.post=(n,o,a,i)=>{(a===r?e:t)(n,o,void 0,i)}}function Pt(e){for(let t=0;t<e.length;t++){const{id:n}=e[t];yt[n]&&(1===gt[n]&&(gt[n]=d),delete yt[n])}}function Ut(e,t){const{post:n}=nt;if(n)return n("WriteVault",e,f,t),!0}function It(e){if(!e)return;const t=G(z(),Ce),n=G(z(),Ce);return P(Z,["log","info","warn","error","debug"],e=>{n[e]=exportFunction(ve[e],Ce)}),t.console=n,e[1]=t,!0}L(n,e,1,!1),Ze({InjectList:xe&&Dt});const Ot=z();Ze({async Notification(e,t){const n=await Te("Notification",e);Ot[n]={id:e.id,realm:t}},RemoveNotification(e){for(const t in Ot)if(Ot[t].id===e)return delete Ot[t],Te("RemoveNotification",t)}}),et({NotificationClick(e){const t=Ot[e];t&&nt.post("NotificationClicked",t.id,t.realm)},NotificationClose(e){const t=Ot[e];t&&(nt.post("NotificationClosed",t.id,t.realm),delete Ot[e])}});const{fetch:Ft,FileReader:Nt,FormData:Vt}=t,{arrayBuffer:Bt,blob:At}=Q,{createObjectURL:Ht,revokeObjectURL:qt}=URL,Gt=U[v],Wt=pe(Gt,"type").get,Jt=pe(fe(A[v]),"buffer").get,Xt=pe(Nt[v],"result").get,zt=Nt[v].readAsDataURL,Kt=Vt[v].append,Qt=[_],Yt=z();let Zt=T();async function en(e,t){const n=await P(e.asBlob?At:Bt,await Ft(t));return Te("RevokeBlob",t),n}function tn(e,t){const n=Ht(e),o=Je("a",{href:n,download:t}),a=P(te,Zt,()=>{P(J,o,new F("click")),nn(n)});return Zt=P(te,a,()=>Te("SetTimeout",150)),a}async function nn(e){await Te("SetTimeout",3e3),qt(e)}function on(e,t,n){const o=(t=H(t)).length,a=e.arr||(e.arr=new A(n?n.size:o));for(let e=(null==n?void 0:n.chunk)||0,r=0;r<o;)a[e++]=ae(t,r++);return a}async function an(e,t){if("fd"===t){if(!e.length)return[e,t];const n=new Vt;P(Z,e,e=>P(Kt,n,e[0],e[1])),e=n}const n=_e(e,Gt),o=n?e:await P(At,new B(e)),a=new Nt;return new V(e=>{P(q,a,"load",()=>e([P(Xt,a),P(Wt,o),n])),P(zt,a,o)})}Ze({async HttpRequest(e,t){Yt[e.id]=M({realm:t,asBlob:"blob"===e.xhrType},e,Qt);let{data:n}=e;return!xe&&n.length>1&&"usp"!==n[1]&&(n=await an(n[0],n[1]),e.data=G?G(n,e):n),Te("HttpRequest",e)},AbortRequest:!0}),et({async HttpRequested(e){const{id:t,data:n}=e,o=Yt[t];if(!o)return;if(Y(e,"chunk"))return void on(o,n,e);let a=null==n?void 0:n[h];a&&!xe&&(e.blobbed&&(a=await en(o,a)),e.chunked&&(a=on(o,a),a=o.asBlob?new U([a],{type:e.contentType}):P(Jt,a),delete o.arr),n[h]=a),a&&o[_]&&(o[h]=a),"load"===e.type&&o[_]&&await tn(o[h],o[_]),"loadend"===e.type&&delete Yt[e.id],nt.post("HttpRequested",e,o.realm)}});const rn=z(),sn=z(),cn=z();Ze({async TabOpen({key:e,data:t},n){const{id:o}=await Te("TabOpen",t);rn[e]=o,sn[o]=e,cn[o]=n},TabClose(e){const t=rn[e];e&&!t||Te("TabClose",{id:t})}}),et({TabClosed(e){const t=sn[e],n=cn[e];delete cn[e],delete sn[e],delete rn[t],t&&nt.post("TabClosed",t,n)}});const{[c]:ln}=nt;async function dn(e){const n=t.vmData||await V.race([new V(e=>{t.vmResolve=e}),e]);return delete t.vmResolve,delete t.vmData,n}function un(){try{const t=`"${e}"`,n=Ce.cookie.split(`${t}=`)[1],o=n&&n.split(";",1)[0];if(o){Ce.cookie=`${t}=0; max-age=0; SameSite=Lax`;const e=new XMLHttpRequest,n=`blob:${Re}${o}`;return e.open("get",n,!1),e.send(),URL.revokeObjectURL(n),JSON.parse(e[h])}}catch(e){}}et({Command:e=>nt.post("Command",e,ln[e.id]),Run:e=>ht(e,r),UpdatedValues(e){const t=z(),n=z();P(Z,we(e),o=>{(ln[o]===r?n:t)[o]=e[o]}),Me(t)||nt.post("UpdatedValues",t),Me(n)||nt.post("UpdatedValues",n,r)}}),Ze({TabFocus:!0,UpdateValue:!0}),(async()=>{const e=Ce instanceof XMLDocument,n=un(),o=Te("GetInjected",{url:xe&&location.href,[s]:e,done:!(!n&&!t.vmData)},{retry:!0}),a=n||(xe&&Event[v].composedPath?await dn(o):await o);de(ln,a[c]),nt[u]=a[u],a[i]&&!e&&Mt(a)&&(Ze({GetScriptVer:!0}),nt.post("Expose")),xe&&!a.clipFF&&X("copy",ot,!0),a[m]&&(Qe.forEach(e=>e(a)),await $t(a,e)),Qe.length=0,pt()})().catch(xe&&ve.error),xe&&n===top&&"file:"===location.protocol&&location.pathname.endsWith(".user.js")&&"application/x-javascript"===Ce.contentType&&(async()=>{const{fetch:e,history:n}=t,{referrer:o}=Ce,{text:a}=Q,r="cookie"in Document[v],i=location.href,s=async()=>P(a,await e(i,{mode:"same-origin"}));let c,l=await s();function d(){n.length>1?n.go(-1):Te("TabClose")}P(ne,l,"// ==UserScript==")<0||(await Te("ConfirmInstall",{code:l,url:i,from:o}),r?ue.runtime.onConnect.addListener(e=>{"FetchSelf"===e.name&&(e.onMessage.addListener(async()=>{l=await s(),l===c?l=null:c=l,e.postMessage(l)}),e.onDisconnect.addListener(async()=>{c=null,await Te("CheckInstallerTab",e.sender.tab.id)||d()}))}):d())})().catch(ve.error)})()}}